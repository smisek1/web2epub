<!-- templates/index.html -->

<!DOCTYPE html>
<html>
<head>
  <title>xpath testing</title>
</head>
<body>
  <h1>xpath testing</h1>
  <table border="1">
    <tr>
      <th>insert/update</th>
      <th>test site</th>
      <th>id_stranka</th>
      <th>jmeno</th>
      <th>link</th>
      <th>xpath_nadpis</th>
      <th>xpath_clanek</th>
      <th>xpath_links</th>
      <th>xpath_datum</th>
      <th>xpath_uvodni_odstavec</th>
      <th>xpath_autor</th>
    </tr>
    {% for row in stranky %}
    <tr>
	    <td><input type="submit" value="update" ></td>
      <td><input type="text" value=""></td>
	    <td>{{ row[0] }}</td>
      <td><input type="text" value="{{ row[1] }}"></td>
      <td><input type="text" value="{{ row[2] }}"></td>
      <td><input type="text" value="{{ row[3] }}"><button class="test-button">Test</button></td>
      <td><input type="text" value="{{ row[4] }}"><button class="test-button">Test</button></td>
      <td><input type="text" value="{{ row[5] }}"><button class="test-button">Test</button></td>
      <td><input type="text" value="{{ row[6] }}"><button class="test-button">Test</button></td> 
      <td><input type="text" value="{{ row[7] }}"><button class="test-button">Test</button></td>
      <td><input type="text" value="{{ row[8] }}"><button class="test-button">Test</button></td>
    </tr>
    {% endfor %}
    <tr>
      <th><input type="submit" value="insert"></th>
      <th>test site</th>
      <th>id_stranka</th>
      <th><input type="text"></th>
      <th><input type="text"></th>
      <th><input type="text"></th>
      <th><input type="text"></th>
      <th><input type="text"></th>
      <th><input type="text"></th>
      <th><input type="text"></th>
      <th><input type="text"></th>
    </tr>
  </table>

<div id="extracted-text"></div>

<script>
	// Get buttons and extracted text div
const buttons = document.querySelectorAll('.test-button');
const extractedText = document.getElementById('extracted-text');

// Loop through buttons
buttons.forEach(function(button) {

  // Handle click event
  button.addEventListener('click', function() {

    // Get xpath value
    const xpath = this.parentElement.querySelector('input').value;

    // Get row values
    const row = this.parentElement.parentElement;
    const values = getRowValues(row);

    // Display xpath and values
    showExtractedText(xpath, values);

  });

});

// Get array of values from row
function getRowValues(row) {

  const values = [];

  for (let i = 0; i < row.cells.length; i++) {
    values.push(row.cells[i].textContent);
  }

  return values;
}

// Display extracted data
function showExtractedText(xpath, values) {

  extractedText.innerHTML = `
    XPath: ${xpath}
    Values: ${values.join('<br>')}
  `;

  extractedText.style.display = 'block';

}
</script>


</body>
</html>
